<ProjectConfig>
  <Project name="mag_zone_dynamic" location="/home/karthik/simtravel/test/mag_zone_dynamic/" seed="10" iteration="3" subsample="40000"/>
  <DTAConnection value="True"/>
  <DBConfig dbprotocol="postgres" dbhost="localhost" dbname="mag_zone_dynamic" dbusername="postgres" dbpassword="1234"/>

  <TravelSkims reference_tablename="travel_skims" indb="True">
    <Period tablename="travel_skims_0" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="0" intervalEnd="60" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim0.dat" delimiter=","/>
    <Period tablename="travel_skims_1" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="61" intervalEnd="120" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim1.dat" delimiter=","/>
    <Period tablename="travel_skims_2" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="121" intervalEnd="180" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim2.dat" delimiter=","/>
    <Period tablename="travel_skims_3" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="181" intervalEnd="240" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim3.dat" delimiter=","/>
    <Period tablename="travel_skims_4" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="241" intervalEnd="300" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim4.dat" delimiter=","/>
    <Period tablename="travel_skims_5" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="301" intervalEnd="360" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim5.dat" delimiter=","/>
    <Period tablename="travel_skims_6" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="361" intervalEnd="420" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim6.dat" delimiter=","/>
    <Period tablename="travel_skims_7" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="421" intervalEnd="480" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim7.dat" delimiter=","/>
    <Period tablename="travel_skims_8" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="481" intervalEnd="540" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim8.dat" delimiter=","/>
    <Period tablename="travel_skims_9" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="541" intervalEnd="600" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim9.dat" delimiter=","/>
    <Period tablename="travel_skims_10" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="601" intervalEnd="660" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim10.dat" delimiter=","/>
    <Period tablename="travel_skims_11" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="661" intervalEnd="720" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim11.dat" delimiter=","/>
    <Period tablename="travel_skims_12" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="721" intervalEnd="780" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim12.dat" delimiter=","/>
    <Period tablename="travel_skims_13" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="781" intervalEnd="840" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim13.dat" delimiter=","/>
    <Period tablename="travel_skims_14" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="841" intervalEnd="900" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim14.dat" delimiter=","/>
    <Period tablename="travel_skims_15" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="901" intervalEnd="960" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim15.dat" delimiter=","/>
    <Period tablename="travel_skims_16" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="961" intervalEnd="1020" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim16.dat" delimiter=","/>
    <Period tablename="travel_skims_17" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1021" intervalEnd="1080" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim17.dat" delimiter=","/>
    <Period tablename="travel_skims_18" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1081" intervalEnd="1140" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim18.dat" delimiter=","/>
    <Period tablename="travel_skims_19" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1141" intervalEnd="1200" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim19.dat" delimiter=","/>
    <Period tablename="travel_skims_20" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1201" intervalEnd="1260" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim20.dat" delimiter=","/>
    <Period tablename="travel_skims_21" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1261" intervalEnd="1320" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim21.dat" delimiter=","/>
    <Period tablename="travel_skims_22" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1321" intervalEnd="1380" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim22.dat" delimiter=","/>
    <Period tablename="travel_skims_23" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="1381" intervalEnd="1440" fileLocation="/home/karthik/simtravel/test/mag_zone_dynamic/skimOutput/dynamic/skim23.dat" delimiter=","/>

  </TravelSkims>

  <Locations reference_tablename="locations" tablename="locations" location_var="locationid" indb="True">
    <LocationVariable var="retail_employment"/>

    <LocationVariable var="retail_employment_density"/>
    <LocationVariable var="other_employment_density"/>
    <LocationVariable var="office_employment_density"/>

    <LocationVariable var="total_area"/>

    <LocationVariable var="low_income"/>
    <LocationVariable var="high_income"/>

  </Locations>

  <ModelConfig>

    <Component name="CleanAggregateActivitySchedule" read_from_table="schedule_final_r" write_to_table="schedule_aggregatefinal_r" key="houseid,personid" location="True" skip="False" completed="True">
      <DBTables>
    	<Table table="persons_daily_status_r" key="houseid,personid"/>
    	<Table table="schedule_final_r" key="houseid,personid" order="1"/>
    	<Table table="schedule_aggregatefinal_r" key="houseid,personid"/>
      </DBTables>

      <Model name="CleanFixedActivitySchedulesofChildren" formulation="Clean Aggregate Activity Schedule" seed="1">
	<DependentVariable var="cleanfixedactivityschedulesofchildren"/>

	<ActivityAttributes>
	  <HouseholdIdName table="schedule_final_r" var="houseid"/>
	  <PersonIdName table="schedule_final_r" var="personid"/>
	  <ScheduleIdName table="schedule_final_r" var="scheduleid"/>
	  <ActivityTypeName table="schedule_final_r" var="activitytype"/>
	  <LocationIdName table="schedule_final_r" var="locationid"/>
	  <StartTimeName table="schedule_final_r" var="starttime"/>
	  <EndTimeName table="schedule_final_r" var="endtime"/>
	  <DurationName table="schedule_final_r" var="duration"/>
	  <DependentPersonName table="schedule_final_r" var="dependentpersonid"/>
	  <TripCountName table="schedule_final_r" var="tripcount"/>
	</ActivityAttributes>

	<DailyStatus>
	  <DailySchoolStatus table="persons_daily_status_r" var="schdailystatus"/>
	  <DailyWorkStatus table="persons_daily_status_r" var="wrkdailystatus"/>
	</DailyStatus>
	
	<Dependency>
	  <ChildDependency table="persons_daily_status_r" var="dependency"/>
	</Dependency>
      </Model>
    </Component>	

    <Component name="ChildDependencyResolution" read_from_table="schedule_aggregatefinal_r" write_to_table="schedule_full_r" key="houseid,personid" location="True" skip="False" completed="True">
      <DBTables>
    	<Table table="persons_daily_status_r" key="houseid,personid"/>
    	<Table table="schedule_aggregatefinal_r" key="houseid,personid" order="1"/>
    	<Table table="schedule_full_r" key="houseid,personid"/>
      </DBTables>

      <Model name="ChildDependencyAllocation" formulation="Child Dependency" type="Resolution" seed="1">
	<DependentVariable var="childdependencyallocation"/>

	<ActivityAttributes>
	  <HouseholdIdName table="schedule_aggregatefinal_r" var="houseid"/>
	  <PersonIdName table="schedule_aggregatefinal_r" var="personid"/>
	  <ScheduleIdName table="schedule_aggregatefinal_r" var="scheduleid"/>
	  <ActivityTypeName table="schedule_aggregatefinal_r" var="activitytype"/>
	  <LocationIdName table="schedule_aggregatefinal_r" var="locationid"/>
	  <StartTimeName table="schedule_aggregatefinal_r" var="starttime"/>
	  <EndTimeName table="schedule_aggregatefinal_r" var="endtime"/>
	  <DurationName table="schedule_aggregatefinal_r" var="duration"/>
	  <DependentPersonName table="schedule_aggregatefinal_r" var="dependentpersonid"/>
	  <TripCountName table="schedule_aggregatefinal_r" var="tripcount"/>
	</ActivityAttributes>

	<DailyStatus>
	  <DailySchoolStatus table="persons_daily_status_r" var="schdailystatus"/>
	  <DailyWorkStatus table="persons_daily_status_r" var="wrkdailystatus"/>
	</DailyStatus>
	
	<Dependency>
	  <ChildDependency table="persons_daily_status_r" var="dependency"/>
	</Dependency>
      </Model>
   </Component>	

    <Component name="TourAttributeProcessing" read_from_table="trips_r" write_to_table="tours_r" key="houseid,personid" location="True" skip="True" completed="True">
      <DBTables>
    	<Table table="trips_r" key="houseid,personid" order="1"/>
    	<Table table="tours_r" key="houseid,personid"/>
      </DBTables>

      <Model name="tourattributes" formulation="Process Tour Attributes" seed="1">
	<DependentVariable var="tourattributes"/>

	  <Id>
	    <HouseId table="trips_r" var="houseid"/>
	    <PersonId table="trips_r" var="personid"/>
	  </Id>

	  <TripAttributes>
	    <VehIdName table="trips_r" var="trippurposefrom"/>
	    <ModeName table="trips_r" var="trippurposefrom"/>
	    <FromZoneName table="trips_r" var="trippurposefrom"/>		
	    <ToZoneName table="trips_r" var="trippurposefrom"/>
	    <StarttimeName table="trips_r" var="trippurposefrom"/>
	    <EndtimeName table="trips_r" var="trippurposefrom"/>
	    <TripPurposeName table="trips_r" var="trippurposefrom"/>
	    <DurationName table="trips_r" var="trippurposefrom"/>
	    <TripPurposeFromName table="trips_r" var="trippurposefrom"/>
	    <OccupancyName table="trips_r" var="trippurposefrom"/>
	    <TripIndName table="trips_r" var="trippurposefrom"/>
	    <DependentPersonIdName table="trips_r" var="trippurposefrom"/>
	  </TripAttributes>

      </Model>
    </Component>	

    <Component name="CalculateGapFunction" read_from_table="trips_arrival_from_malta_r" write_to_table="gap_function_r" skip="False" completed="True">
      <DBTables>
    	<Table table="trips_arrival_from_malta_r" key="tripid" order="1"/>
    	<Table table="trips_r" key="tripid"/>
    	<Table table="gap_function_r" key="tripid"/>
      </DBTables>
      <AnalysisInterval start="0" end="1440" step="1"/>

      <AnalysisIntervalFilter table="trips_arrival_from_malta_r" var="arrivaltime"/>

      <Model name="houseidDummy" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="houseid"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="houseid" coeff="1"/>
      </Model>
      <Model name="personidDummy" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="personid"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="personid" coeff="1"/>
      </Model>

      <Model name="from" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="from"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="fromzone" coeff="1"/>
      </Model>
      <Model name="to" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="to"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="tozone" coeff="1"/>
      </Model>
      <Model name="tt_experienced" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tt_experienced"/>
	<Variance value="0"/>
        <Variable table="trips_arrival_from_malta_r" var="arrivaltime" coeff="1"/>
        <Variable table="trips_r" var="starttime" coeff="-1"/>
      </Model>
      <Model name="tt_expected" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tt_expected"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="endtime" coeff="1"/>
        <Variable table="trips_r" var="starttime" coeff="-1"/>
      </Model>
      <DynamicSpatialConstraints table="travel_skims" skim_var="tt" as_var="sp_tt" origin_var="origin" destination_var="destination" after_model="tt_expected" before_model="gap_after">
	<Start table="runtime" location_var="from"/>
	<End table="runtime" location_var="tozone"/>
      </DynamicSpatialConstraints>
      <Model name="gap_after" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="gap_after"/>
	<Variance value="0"/>
        <Variable table="runtime" var="sp_tt" coeff="-1"/>
        <Variable table="runtime" var="tt_experienced" coeff="1"/>
      </Model>
      <Model name="gap_before" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="gap_before"/>
	<Variance value="0"/>
        <Variable table="runtime" var="tt_expected" coeff="-1"/>
        <Variable table="runtime" var="tt_experienced" coeff="1"/>
      </Model>

    </Component>

    <Component name="OD_OutputTable" read_from_table="trips_r" write_to_table="od_r" skip="False" completed="True">
      <DBTables>
    	<Table table="trips_r" key="houseid,personid" order="1"/>
    	<Table table="od_r" key="origin,destination"/>
      </DBTables>
      <Aggregate>	
	<Variable table="trips_r" var="fromzone"/>
	<Variable table="trips_r" var="tozone"/>
      </Aggregate>
      <Model name="origin" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="origin"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="fromzone" coeff="1"/>
      </Model>
      <Model name="destination" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="destination"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="tozone" coeff="1"/>
      </Model>
      <Model name="count" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="count"/>
	<Variance value="0"/>
        <Variable table="runtime" var="frequency" coeff="1"/>
      </Model>

    </Component>

    <Component name="Gap_Before_R" read_from_table="gap_function_r" write_to_table="gap_before_r" skip="False" completed="True">
      <DBTables>
    	<Table table="gap_function_r" key="tripid" order="1"/>
    	<Table table="gap_before_r" key="gap_before"/>
      </DBTables>
      <Aggregate>	
	<Variable table="gap_function_r" var="gap_before"/>
      </Aggregate>

      <Model name="count" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="count"/>
	<Variance value="0"/>
        <Variable table="runtime" var="frequency" coeff="1"/>
      </Model>

    </Component>

    <Component name="Gap_After_R" read_from_table="gap_function_r" write_to_table="gap_after_r" skip="False" completed="True">
      <DBTables>
    	<Table table="gap_function_r" key="tripid" order="1"/>
    	<Table table="gap_after_r" key="gap_after"/>
      </DBTables>
      <Aggregate>	
	<Variable table="gap_function_r" var="gap_after"/>
      </Aggregate>
      <Model name="count" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="count"/>
	<Variance value="0"/>
        <Variable table="runtime" var="frequency" coeff="1"/>
      </Model>

    </Component>



  </ModelConfig>
</ProjectConfig>
